LOAD CSV WITH HEADERS FROM "https://raw.githubusercontent.com/mneedham/neo4j-got/master/data/import/characters.csv" AS row MERGE (c:Character {id: row.link}) ON CREATE SET c.name = row.character
LOAD CSV WITH HEADERS FROM "https://raw.githubusercontent.com/mneedham/neo4j-got/master/data/import/overview.csv" AS row MERGE (episode:Episode {id: toInteger(row.episodeId)}) ON CREATE SET episode.season = toInteger(row.season), episode.number = toInteger(row.episode), episode.title = row.title
LOAD CSV WITH HEADERS FROM "https://raw.githubusercontent.com/mneedham/neo4j-got/master/data/import/characters_episodes.csv" AS row
MATCH (episode:Episode {id: toInteger(row.episodeId)}) MATCH (character:Character {id: row.character}) MERGE (character)-[:APPEARED_IN]->(episode)
LOAD CSV WITH HEADERS FROM "https://raw.githubusercontent.com/mneedham/neo4j-got/master/data/import/houses.csv" AS row MERGE (house:House {id: row.link}) ON CREATE SET house.name = row.name
LOAD CSV WITH HEADERS FROM "https://raw.githubusercontent.com/mneedham/neo4j-got/master/data/import/characters_houses.csv" AS row MATCH (character:Character {id: row.character}) MATCH (house:House {id: row.house}) MERGE (character)-[:HAS_ALLEGIANCE_TO]->(house)
LOAD CSV WITH HEADERS FROM "https://raw.githubusercontent.com/mneedham/neo4j-got/master/data/import/family_ties.csv" AS row RETURN DISTINCT row.relationship, row.type
LOAD CSV WITH HEADERS FROM "https://raw.githubusercontent.com/mneedham/neo4j-got/master/data/import/family_ties.csv" AS row WITH row WHERE row.relationship = "mother" MATCH (character1:Character {id: row.character1}) MATCH (character2:Character {id: row.character2}) MERGE (character2)-[:PARENT_OF {type: "mother"}]->(character1)
LOAD CSV WITH HEADERS FROM "https://raw.githubusercontent.com/mneedham/neo4j-got/master/data/import/family_ties.csv" AS row WITH row WHERE row.relationship = "father" MATCH (character1:Character {id: row.character1}) MATCH (character2:Character {id: row.character2}) MERGE (character2)-[:PARENT_OF {type: row.type + " " + row.relationship}]->(character1)